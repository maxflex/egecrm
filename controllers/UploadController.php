<?php	// Контроллер загрузок	class UploadController extends Controller	{		public $defaultAction = "AjaxUpload";				// Папка вьюх		protected $_viewsFolder	= "";				const CONTRACTS_DIR = "files/contracts/";						##################################################		###################### AJAX ######################		##################################################						/**		 * Загрузка электронной версии договора.		 * 		 */		public function actionAjaxContract() 		{				$handle = new upload($_FILES['contract_digital']);						if ($handle->uploaded) {				$handle->file_overwrite = true;								// Получаем контракт				$Contract = Contract::findById($_GET["contract_id"]);								// Переименовываем файл в ID контракта				$handle->file_new_name_body = $Contract->id;								$handle->process(self::CONTRACTS_DIR);								// Сохраняем имя файла				$Contract->file = $handle->file_dst_name;				$Contract->save("file");								if ($handle->processed) {					toJson([						"file" => $Contract->file					]);				} else {					toJson("ERROR");				}			} else {				toJson("ERROR");			}		}				public function actionAjaxUpload()		{			preType($_FILES);						if($_FILES) {							    $_FILES = $_FILES["files"];			    $file_name 	= $_FILES['name'][0];			    $file_size 	= $_FILES['size'][0];			    $file_tmp 	= $_FILES['tmp_name'][0];			    $file_type	= $_FILES['type'][0];   			   			    $file_ext=strtolower(end(explode('.', $file_name)));			    echo "FILENAME=$file_name";			    echo $file_ext;			    			    $extensions = array("jpeg","jpg","png");			    			    if(in_array($file_ext, $extensions ) === false){			    	$errors[]="extension not allowed, please choose a JPEG or PNG file.";			    }			    			    if($file_size > 2097152){			    	$errors[]='File size must be excately 2 MB';			    }							    			    if(empty($errors)==true) {//				    echo "<h4>".getcwd()." | $file_tmp | $file_name</h4>";			        move_uploaded_file($file_tmp,"img/".$file_name);//			        echo "Success";			    } else {			        print_r($errors);			    }			}		}			}