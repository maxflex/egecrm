<?php	// Контроллер	class UsersController extends Controller	{		public $defaultAction = "list";				// Папка вьюх		protected $_viewsFolder	= "users";				public function beforeAction()		{			$this->addJs("ng-users-app");		}				public function actionList()		{				$this->setTabTitle("Пользователи");						$Users = User::findAll([				"condition" => "type='USER' OR type='SEO'",				"order" => "type DESC"			]);						foreach ($Users as &$User) {				$User = $User->dbData(["id", "login", "banned", "banned_egerep", "agreement", "color", 'show_phone_calls']);			}						$ang_init_data = angInit([				"Users" => $Users,			]);						$this->render("list", [				"ang_init_data" => $ang_init_data,			]);		}        public function actionEdit()		{            if (!($id = intval($_GET['id']))) {                $this->redirect("users");            }            $this->setTabTitle("Пользователь #{$id}");			$User = User::findById($id);			$ang_init_data = angInit([				"User" => $User,			]);			$this->render("edit", [				"ang_init_data" => $ang_init_data,			]);		}				public function actionAjaxSave()		{			$Users = $_POST["Users"];						foreach ($Users as $User) {				if (!empty($User['new_password'])) {					$User['password'] = User::password($User['new_password']);				}				User::updateById($User['id'], $User);			}						# обновить кеш			User::updateCache();		}        public function actionAjaxDeletePhoto() {            extract($_POST);            $User = User::findById($user_id);            unlink($User->photoPath());            unlink($User->photoPath('_original'));            $User->photo_extension = '';            $User->save('photo_extension');        }	}